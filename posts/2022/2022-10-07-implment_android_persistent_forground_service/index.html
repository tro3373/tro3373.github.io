<!doctype html><html lang=ja dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する | tac lifelog</title><meta name=keywords content="android,kotlin"><meta name=description content="Android で 位置情報取得を定期実行する方法をしらべたので、メモっておく
Foreground 実装 フォアグラウンドサービスの最低限の実装について【Kotlin, Android Studio, バックグラウンドでのアプリ実行】 - アンラッキーシステムズのやり方、方法論。 Foreground Serviceの基本 - Qiita AndroidアプリでForeground Serviceを使って、画面スリープ状態でも位置情報を定期取得する | DevelopersIO Android Service の使い方 趣味のプログラム: Android Foreground Serviceのメモ フォアグラウンド サービスの起動に関する制限 | Android 12 | Android Developers Android - Foreground Service実行 長期間Serviceを起動したい時 | 技術情報 | アプリ関連ニュース | ギガスジャパン Auto-Start Foreground Service in Android | by CodingwithSaud | The Startup | Medium Androidアプリでバックグラウンド状態で位置情報が取得できるのか調査した - 酢ろぐ！ バックグラウンドで位置情報アクセスするアプリには特別な審査が必要
審査に必要なものは、Google公式のバックグラウンド位置情報にアクセスするアプリの審査を円滑に進めるためのヒントにも書かれている通り以下のものを準備する必要がある。
機密情報に関わる申請 を行う ・デモ動画が必要 アプリ内での位置情報使用の開示を行う (位置情報許諾ダイアログ) プライバシーポリシー にバックグラウンドで位置情報を取得する件について書く"><meta name=author content><link rel=canonical href=https://tro3373.github.io/posts/2022/2022-10-07-implment_android_persistent_forground_service/><meta name=google-site-verification content="gFn4gbm1K_1qzq7At2Sr1-7AuHC45a6pCmvAdUNeUGY"><link crossorigin=anonymous href=/assets/css/stylesheet.0c4fd3725171366f335155acde6fb3c7b7042cd2fd075bebf5023d9b28a701b2.css integrity="sha256-DE/TclFxNm8zUVWs3m+zx7cELNL9B1vr9QI9myinAbI=" rel="preload stylesheet" as=style><link rel=stylesheet href=/scss/style.min.7b5d7016468d598a3e753e3d0ecf004679e628a19804af57943ee84be5b7770a.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/base16/apprentice.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/vim.min.js></script>
<script type=text/javascript src=/js/terraform.js></script>
<script type=text/javascript>hljs.registerLanguage("terraform",window.hljsDefineTerraform),hljs.highlightAll()</script><link rel=icon href=https://tro3373.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tro3373.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=32x32 href=https://tro3373.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://tro3373.github.io/favicon-32x32.png><link rel=mask-icon href=https://tro3373.github.io/favicon-32x32.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6962926171897574" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-20M4SHCC18"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-20M4SHCC18",{anonymize_ip:!1})}</script><meta property="og:title" content="Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する"><meta property="og:description" content="Android で 位置情報取得を定期実行する方法をしらべたので、メモっておく
Foreground 実装 フォアグラウンドサービスの最低限の実装について【Kotlin, Android Studio, バックグラウンドでのアプリ実行】 - アンラッキーシステムズのやり方、方法論。 Foreground Serviceの基本 - Qiita AndroidアプリでForeground Serviceを使って、画面スリープ状態でも位置情報を定期取得する | DevelopersIO Android Service の使い方 趣味のプログラム: Android Foreground Serviceのメモ フォアグラウンド サービスの起動に関する制限 | Android 12 | Android Developers Android - Foreground Service実行 長期間Serviceを起動したい時 | 技術情報 | アプリ関連ニュース | ギガスジャパン Auto-Start Foreground Service in Android | by CodingwithSaud | The Startup | Medium Androidアプリでバックグラウンド状態で位置情報が取得できるのか調査した - 酢ろぐ！ バックグラウンドで位置情報アクセスするアプリには特別な審査が必要
審査に必要なものは、Google公式のバックグラウンド位置情報にアクセスするアプリの審査を円滑に進めるためのヒントにも書かれている通り以下のものを準備する必要がある。
機密情報に関わる申請 を行う ・デモ動画が必要 アプリ内での位置情報使用の開示を行う (位置情報許諾ダイアログ) プライバシーポリシー にバックグラウンドで位置情報を取得する件について書く"><meta property="og:type" content="article"><meta property="og:url" content="https://tro3373.github.io/posts/2022/2022-10-07-implment_android_persistent_forground_service/"><meta property="og:image" content="https://tro3373.github.io/img.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-07T18:41:13+09:00"><meta property="article:modified_time" content="2023-05-13T17:16:54+09:00"><meta property="og:site_name" content="tac lifelog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tro3373.github.io/img.jpg"><meta name=twitter:title content="Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する"><meta name=twitter:description content="Android で 位置情報取得を定期実行する方法をしらべたので、メモっておく
Foreground 実装 フォアグラウンドサービスの最低限の実装について【Kotlin, Android Studio, バックグラウンドでのアプリ実行】 - アンラッキーシステムズのやり方、方法論。 Foreground Serviceの基本 - Qiita AndroidアプリでForeground Serviceを使って、画面スリープ状態でも位置情報を定期取得する | DevelopersIO Android Service の使い方 趣味のプログラム: Android Foreground Serviceのメモ フォアグラウンド サービスの起動に関する制限 | Android 12 | Android Developers Android - Foreground Service実行 長期間Serviceを起動したい時 | 技術情報 | アプリ関連ニュース | ギガスジャパン Auto-Start Foreground Service in Android | by CodingwithSaud | The Startup | Medium Androidアプリでバックグラウンド状態で位置情報が取得できるのか調査した - 酢ろぐ！ バックグラウンドで位置情報アクセスするアプリには特別な審査が必要
審査に必要なものは、Google公式のバックグラウンド位置情報にアクセスするアプリの審査を円滑に進めるためのヒントにも書かれている通り以下のものを準備する必要がある。
機密情報に関わる申請 を行う ・デモ動画が必要 アプリ内での位置情報使用の開示を行う (位置情報許諾ダイアログ) プライバシーポリシー にバックグラウンドで位置情報を取得する件について書く"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://tro3373.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する","item":"https://tro3373.github.io/posts/2022/2022-10-07-implment_android_persistent_forground_service/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する","name":"Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する","description":"Android で 位置情報取得を定期実行する方法をしらべたので、メモっておく\nForeground 実装 フォアグラウンドサービスの最低限の実装について【Kotlin, Android Studio, バックグラウンドでのアプリ実行】 - アンラッキーシステムズのやり方、方法論。 Foreground Serviceの基本 - Qiita AndroidアプリでForeground Serviceを使って、画面スリープ状態でも位置情報を定期取得する | DevelopersIO Android Service の使い方 趣味のプログラム: Android Foreground Serviceのメモ フォアグラウンド サービスの起動に関する制限 | Android 12 | Android Developers Android - Foreground Service実行 長期間Serviceを起動したい時 | 技術情報 | アプリ関連ニュース | ギガスジャパン Auto-Start Foreground Service in Android | by CodingwithSaud | The Startup | Medium Androidアプリでバックグラウンド状態で位置情報が取得できるのか調査した - 酢ろぐ！ バックグラウンドで位置情報アクセスするアプリには特別な審査が必要\n審査に必要なものは、Google公式のバックグラウンド位置情報にアクセスするアプリの審査を円滑に進めるためのヒントにも書かれている通り以下のものを準備する必要がある。\n機密情報に関わる申請 を行う ・デモ動画が必要 アプリ内での位置情報使用の開示を行う (位置情報許諾ダイアログ) プライバシーポリシー にバックグラウンドで位置情報を取得する件について書く","keywords":["android","kotlin"],"articleBody":"Android で 位置情報取得を定期実行する方法をしらべたので、メモっておく\nForeground 実装 フォアグラウンドサービスの最低限の実装について【Kotlin, Android Studio, バックグラウンドでのアプリ実行】 - アンラッキーシステムズのやり方、方法論。 Foreground Serviceの基本 - Qiita AndroidアプリでForeground Serviceを使って、画面スリープ状態でも位置情報を定期取得する | DevelopersIO Android Service の使い方 趣味のプログラム: Android Foreground Serviceのメモ フォアグラウンド サービスの起動に関する制限 | Android 12 | Android Developers Android - Foreground Service実行 長期間Serviceを起動したい時 | 技術情報 | アプリ関連ニュース | ギガスジャパン Auto-Start Foreground Service in Android | by CodingwithSaud | The Startup | Medium Androidアプリでバックグラウンド状態で位置情報が取得できるのか調査した - 酢ろぐ！ バックグラウンドで位置情報アクセスするアプリには特別な審査が必要\n審査に必要なものは、Google公式のバックグラウンド位置情報にアクセスするアプリの審査を円滑に進めるためのヒントにも書かれている通り以下のものを準備する必要がある。\n機密情報に関わる申請 を行う ・デモ動画が必要 アプリ内での位置情報使用の開示を行う (位置情報許諾ダイアログ) プライバシーポリシー にバックグラウンドで位置情報を取得する件について書く\nAndroid13でアプリ監視強化。電池持ちが改善する可能性も - Gadget Arena フォアグラウンド サービス（FGS）タスク マネージャー | Android デベロッパー | Android Developers Why did Android 13 remove the Foreground Service notification? - Stack Overflow Sorry for the sort of click-bait title; I couldn’t think of a more concise way to say it.\nIn Android 13, if the user doesn’t grant the “dangerous” POST_NOTIFICATION permission, then Foreground Service notifications are not shown in the Notification Drawer. Instead, for the user to see it, they have to navigate to the new Foreground Services Task Manager, according to the documentation:\nIf the user denies the notification permission, they still see notices related to these foreground services in the Foreground Services (FGS) Task Manager but don’t see them in the notification drawer.\nNow I haven’t used the Android 13 Beta so I don’t know exactly how “in the face” the FGS Task Manager will be when Foreground Services are running, but I thought the entire point of forcing Foreground Services to have a notification was so that the user would be aware when the application was running. This even has security consequences because Android restricts what background v.s. foreground processes can do using dangerous permissions (e.g. ACCESS_BACKGROUND_LOCATION). This change essentially allows an app to use foreground based permissions without clearly notifiying the user.\nSo, why did they decide to restrict Foreground Service notifications? I mean there is a whole other discussion about the addition of restricting notifications in the first place. But one would think that if Android forces you to use a notification, then there shouldn’t be a way to get around it (i.e. never request the POST_NOTIFICATION permission or even just remove the permission programatically).\nこれ以上簡潔な言い方が思いつかなかったので、クリックしやすいタイトルで申し訳ないです。\nAndroid 13では、ユーザーが「危険な」POST_NOTIFICATION権限を付与していない場合、Foreground Serviceの通知は通知ドロワーに表示されません。その代わり、ドキュメントによると、ユーザーがそれを見るには、新しいフォアグラウンド・サービスのタスク・マネージャーに移動する必要があるそうです。\nユーザーが通知許可を拒否した場合、これらのフォアグラウンドサービスに関連する通知はフォアグラウンドサービス（FGS）タスクマネージャーで引き続き表示されますが、通知ドロワーでは表示されません。\n私はAndroid 13 Betaを使用していないので、フォアグラウンド・サービスが実行されているときにFGSタスク・マネージャがどのように「見える」ようになるか正確にはわかりませんが、フォアグラウンド・サービスに通知を強制する全体のポイントは、アプリケーションが実行されているときにユーザーが認識できるようにすることだと私は考えていました。Androidは、危険なパーミッション（例：ACCESS_BACKGROUND_LOCATION）を使用して、バックグラウンドプロセスとフォアグラウンドプロセスができることを制限しているため、これはセキュリティにも影響を及ぼします。この変更により、アプリはユーザーに明確に通知することなく、フォアグラウンドベースのパーミッションを使用することができます。\nでは、なぜフォアグラウンドサービスの通知を制限することにしたのでしょうか？つまり、そもそも通知を制限することの追加については、全く別の議論があるのです。しかし、Androidが通知の使用を強制するなら、それを回避する方法（つまり、POST_NOTIFICATION権限を決して要求しない、あるいは、プログラム的に権限を削除する）はないはずだと考えるでしょう。\nPendingIntentのFLAG_IMMUTABLEとFLAG_MUTABLE - Kenji Abe - Medium Target SDK 31(Android 12)から PendingIntent のmutability(可変性)を指定する必要があります。\nFLAG_IMMUTABLE FLAG_IMMUTABLE を指定すると、パラメータを追加をしたとしても、元々のIntentは変更はされず、起動された側でも取得できずにnullになります。 ほとんどケースで FLAG_IMMUTABLE を指定することになると思います。\nFLAG_MUTABLE FLAG_MUTABLE を指定すると、変更が可能となり、先程のパラメータを追加したときに、起動された側で取得することが出来ます。\n長時間実行ワーカーをサポートする | Android デベロッパー | Android Developers How To Implement a Foreground Service in Android | by Satya Pavan Kantamani | Better Programming Using foreground services for executing long-running processes in Android | by Harshit Dwivedi | Heartbeat ","wordCount":"412","inLanguage":"ja","image":"https://tro3373.github.io/img.jpg","datePublished":"2022-10-07T18:41:13+09:00","dateModified":"2023-05-13T17:16:54+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://tro3373.github.io/posts/2022/2022-10-07-implment_android_persistent_forground_service/"},"publisher":{"@type":"Organization","name":"tac lifelog","logo":{"@type":"ImageObject","url":"https://tro3373.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tro3373.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://tro3373.github.io/favicon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://tro3373.github.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://tro3373.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://tro3373.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://tro3373.github.io/archives/ title=archives><span>archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://tro3373.github.io/>ホーム</a>&nbsp;»&nbsp;<a href=https://tro3373.github.io/posts/>Posts</a></div><h1 class=post-title>Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する</h1><div class=post-meta><span title='2022-10-07 18:41:13 +0900 JST'><i class='fa-solid fa-pen'></i> 2022-10-07</span>&nbsp;·&nbsp;<span title='2023-05-13 17:16:54 +0900 JST'><i class='fa-solid fa-rotate-right'></i> 2023-05-13</span>&nbsp;·&nbsp;2 分&nbsp;·&nbsp;412 文字</div></header><figure class=entry-cover><img loading=lazy srcset="https://tro3373.github.io/posts/2022/2022-10-07-implment_android_persistent_forground_service/img_hu3d03a01dcc18bc5be0e67db3d8d209a6_5234992_360x0_resize_q75_box.jpg 360w ,https://tro3373.github.io/posts/2022/2022-10-07-implment_android_persistent_forground_service/img_hu3d03a01dcc18bc5be0e67db3d8d209a6_5234992_480x0_resize_q75_box.jpg 480w ,https://tro3373.github.io/posts/2022/2022-10-07-implment_android_persistent_forground_service/img_hu3d03a01dcc18bc5be0e67db3d8d209a6_5234992_720x0_resize_q75_box.jpg 720w ,https://tro3373.github.io/posts/2022/2022-10-07-implment_android_persistent_forground_service/img_hu3d03a01dcc18bc5be0e67db3d8d209a6_5234992_1080x0_resize_q75_box.jpg 1080w ,https://tro3373.github.io/posts/2022/2022-10-07-implment_android_persistent_forground_service/img_hu3d03a01dcc18bc5be0e67db3d8d209a6_5234992_1500x0_resize_q75_box.jpg 1500w ,https://tro3373.github.io/posts/2022/2022-10-07-implment_android_persistent_forground_service/img.jpg 6000w" sizes="(min-width: 768px) 720px, 100vw" src=https://tro3373.github.io/posts/2022/2022-10-07-implment_android_persistent_forground_service/img.jpg alt width=6000 height=4000></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目次</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#androidアプリでバックグラウンド状態で位置情報が取得できるのか調査した---酢ろぐhttpsblogch3coohjpentryandroidget_location_information_in_backgrounde38390e38383e382afe382b0e383a9e382a6e383b3e38389e381a7e4bd8de7bdaee68385e5a0b1e382a2e382afe382bbe382b9e38199e3828be382a2e38397e383aae381abe381afe789b9e588a5e381aae5afa9e69fbbe3818ce5bf85e8a681><a href=https://blog.ch3cooh.jp/entry/android/get_location_information_in_background#%E3%83%90%E3%83%83%E3%82%AF%E3%82%B0%E3%83%A9%E3%82%A6%E3%83%B3%E3%83%89%E3%81%A7%E4%BD%8D%E7%BD%AE%E6%83%85%E5%A0%B1%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%99%E3%82%8B%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AB%E3%81%AF%E7%89%B9%E5%88%A5%E3%81%AA%E5%AF%A9%E6%9F%BB%E3%81%8C%E5%BF%85%E8%A6%81>Androidアプリでバックグラウンド状態で位置情報が取得できるのか調査した - 酢ろぐ！</a></a></li><li><a href=#android13でアプリ監視強化電池持ちが改善する可能性も---gadget-arenahttpspixel-leakercom20220321enhanced-app-monitoring-on-android-13-battery-life-may-improve><a href=https://pixel-leaker.com/2022/03/21/enhanced-app-monitoring-on-android-13-battery-life-may-improve/>Android13でアプリ監視強化。電池持ちが改善する可能性も - Gadget Arena</a></a></li><li><a href=#フォアグラウンド-サービスfgsタスク-マネージャー--android-デベロッパー--android-developershttpsdeveloperandroidcomaboutversions13changesfgs-managerhlja><a href="https://developer.android.com/about/versions/13/changes/fgs-manager?hl=ja">フォアグラウンド サービス（FGS）タスク マネージャー  |  Android デベロッパー  |  Android Developers</a></a></li><li><a href=#why-did-android-13-remove-the-foreground-service-notification---stack-overflowhttpsstackoverflowcomquestions72664186why-did-android-13-remove-the-foreground-service-notification><a href=https://stackoverflow.com/questions/72664186/why-did-android-13-remove-the-foreground-service-notification>Why did Android 13 remove the Foreground Service notification? - Stack Overflow</a></a></li><li><a href=#pendingintentのflag_immutableとflag_mutable---kenji-abe---mediumhttpsstar-zeromediumcompendingintente381aeflag-immutablee381a8flag-mutable-d72bf7c90135><a href=https://star-zero.medium.com/pendingintent%E3%81%AEflag-immutable%E3%81%A8flag-mutable-d72bf7c90135>PendingIntentのFLAG_IMMUTABLEとFLAG_MUTABLE - Kenji Abe - Medium</a></a></li><li><a href=#長時間実行ワーカーをサポートする--android-デベロッパー--android-developershttpsdeveloperandroidcomtopiclibrariesarchitectureworkmanageradvancedlong-runninghlja><a href="https://developer.android.com/topic/libraries/architecture/workmanager/advanced/long-running?hl=ja">長時間実行ワーカーをサポートする  |  Android デベロッパー  |  Android Developers</a></a></li><li><a href=#how-to-implement-a-foreground-service-in-android--by-satya-pavan-kantamani--better-programminghttpsbetterprogrammingpubwhat-is-foreground-service-in-android-3487d9719ab6><a href=https://betterprogramming.pub/what-is-foreground-service-in-android-3487d9719ab6>How To Implement a Foreground Service in Android | by Satya Pavan Kantamani | Better Programming</a></a></li><li><a href=#using-foreground-services-for-executing-long-running-processes-in-android--by-harshit-dwivedi--heartbeathttpsheartbeatcometmlusing-foreground-services-for-executing-long-running-processes-in-android-fac0b8585c3a><a href=https://heartbeat.comet.ml/using-foreground-services-for-executing-long-running-processes-in-android-fac0b8585c3a>Using foreground services for executing long-running processes in Android | by Harshit Dwivedi | Heartbeat</a></a></li></ul></nav></div></details></div><div class=post-content><p>Android で 位置情報取得を定期実行する方法をしらべたので、メモっておく</p><h1 id=foreground-実装>Foreground 実装<a hidden class=anchor aria-hidden=true href=#foreground-実装>#</a></h1><ul><li><p><a class=link href=https://unluckysystems.com/%E3%83%90%E3%83%83%E3%82%AF%E3%82%B0%E3%83%A9%E3%82%A6%E3%83%B3%E3%83%89%E3%81%A7%E5%8B%95%E4%BD%9C%E3%81%95%E3%81%9B%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E3%83%95%E3%82%A9%E3%82%A2%E3%82%B0%E3%83%A9/ target=_blank rel=noopener>フォアグラウンドサービスの最低限の実装について【Kotlin, Android Studio, バックグラウンドでのアプリ実行】 - アンラッキーシステムズのやり方、方法論。</a></p></li><li><p><a class=link href=https://qiita.com/naoi/items/03e76d10948fe0d45597 target=_blank rel=noopener>Foreground Serviceの基本 - Qiita</a></p></li><li><p><a class=link href=https://dev.classmethod.jp/articles/android-use-foreground-service-for-location-background/ target=_blank rel=noopener>AndroidアプリでForeground Serviceを使って、画面スリープ状態でも位置情報を定期取得する | DevelopersIO</a></p></li><li><p><a class=link href=https://akira-watson.com/android/service.html target=_blank rel=noopener>Android Service の使い方</a></p></li><li><p><a class=link href=https://pdfandfont.blogspot.com/2020/07/android-foreground-service.html target=_blank rel=noopener>趣味のプログラム: Android Foreground Serviceのメモ</a></p></li><li><p><a class=link href="https://developer.android.com/about/versions/12/foreground-services?hl=ja" target=_blank rel=noopener>フォアグラウンド サービスの起動に関する制限  |  Android 12  |  Android Developers</a></p></li><li><p><a class=link href=https://codechacha.com/ja/android-start-foreground-service/ target=_blank rel=noopener>Android - Foreground Service実行</a></p></li><li><p><a class=link href=https://www.gigas-jp.com/appnews/archives/6228 target=_blank rel=noopener>長期間Serviceを起動したい時 | 技術情報 | アプリ関連ニュース | ギガスジャパン</a></p></li><li><p><a class=link href=https://medium.com/swlh/all-about-auto-start-foreground-service-in-android-8bba7569123e target=_blank rel=noopener>Auto-Start Foreground Service in Android | by CodingwithSaud | The Startup | Medium</a></p></li></ul><h2 id=androidアプリでバックグラウンド状態で位置情報が取得できるのか調査した---酢ろぐhttpsblogch3coohjpentryandroidget_location_information_in_backgrounde38390e38383e382afe382b0e383a9e382a6e383b3e38389e381a7e4bd8de7bdaee68385e5a0b1e382a2e382afe382bbe382b9e38199e3828be382a2e38397e383aae381abe381afe789b9e588a5e381aae5afa9e69fbbe3818ce5bf85e8a681><a class=link href=https://blog.ch3cooh.jp/entry/android/get_location_information_in_background#%E3%83%90%E3%83%83%E3%82%AF%E3%82%B0%E3%83%A9%E3%82%A6%E3%83%B3%E3%83%89%E3%81%A7%E4%BD%8D%E7%BD%AE%E6%83%85%E5%A0%B1%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%99%E3%82%8B%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AB%E3%81%AF%E7%89%B9%E5%88%A5%E3%81%AA%E5%AF%A9%E6%9F%BB%E3%81%8C%E5%BF%85%E8%A6%81 target=_blank rel=noopener>Androidアプリでバックグラウンド状態で位置情報が取得できるのか調査した - 酢ろぐ！</a></h2><blockquote><p>バックグラウンドで位置情報アクセスするアプリには特別な審査が必要</p></blockquote><blockquote><p>審査に必要なものは、Google公式のバックグラウンド位置情報にアクセスするアプリの審査を円滑に進めるためのヒントにも書かれている通り以下のものを準備する必要がある。</p><p>機密情報に関わる申請 を行う ・デモ動画が必要
アプリ内での位置情報使用の開示を行う (位置情報許諾ダイアログ)
プライバシーポリシー にバックグラウンドで位置情報を取得する件について書く</p></blockquote><h2 id=android13でアプリ監視強化電池持ちが改善する可能性も---gadget-arenahttpspixel-leakercom20220321enhanced-app-monitoring-on-android-13-battery-life-may-improve><a class=link href=https://pixel-leaker.com/2022/03/21/enhanced-app-monitoring-on-android-13-battery-life-may-improve/ target=_blank rel=noopener>Android13でアプリ監視強化。電池持ちが改善する可能性も - Gadget Arena</a></h2><h2 id=フォアグラウンド-サービスfgsタスク-マネージャー--android-デベロッパー--android-developershttpsdeveloperandroidcomaboutversions13changesfgs-managerhlja><a class=link href="https://developer.android.com/about/versions/13/changes/fgs-manager?hl=ja" target=_blank rel=noopener>フォアグラウンド サービス（FGS）タスク マネージャー  |  Android デベロッパー  |  Android Developers</a></h2><h2 id=why-did-android-13-remove-the-foreground-service-notification---stack-overflowhttpsstackoverflowcomquestions72664186why-did-android-13-remove-the-foreground-service-notification><a class=link href=https://stackoverflow.com/questions/72664186/why-did-android-13-remove-the-foreground-service-notification target=_blank rel=noopener>Why did Android 13 remove the Foreground Service notification? - Stack Overflow</a></h2><blockquote><p>Sorry for the sort of click-bait title; I couldn&rsquo;t think of a more concise way to say it.</p><p>In Android 13, if the user doesn&rsquo;t grant the &ldquo;dangerous&rdquo; POST_NOTIFICATION permission, then Foreground Service notifications are not shown in the Notification Drawer. Instead, for the user to see it, they have to navigate to the new Foreground Services Task Manager, according to the documentation:</p><p>If the user denies the notification permission, they still see notices related to these foreground services in the Foreground Services (FGS) Task Manager but don&rsquo;t see them in the notification drawer.</p><p>Now I haven&rsquo;t used the Android 13 Beta so I don&rsquo;t know exactly how &ldquo;in the face&rdquo; the FGS Task Manager will be when Foreground Services are running, but I thought the entire point of forcing Foreground Services to have a notification was so that the user would be aware when the application was running. This even has security consequences because Android restricts what background v.s. foreground processes can do using dangerous permissions (e.g. ACCESS_BACKGROUND_LOCATION). This change essentially allows an app to use foreground based permissions without clearly notifiying the user.</p><p>So, why did they decide to restrict Foreground Service notifications? I mean there is a whole other discussion about the addition of restricting notifications in the first place. But one would think that if Android forces you to use a notification, then there shouldn&rsquo;t be a way to get around it (i.e. never request the POST_NOTIFICATION permission or even just remove the permission programatically).</p></blockquote><blockquote><p>これ以上簡潔な言い方が思いつかなかったので、クリックしやすいタイトルで申し訳ないです。</p><p>Android 13では、ユーザーが「危険な」POST_NOTIFICATION権限を付与していない場合、Foreground Serviceの通知は通知ドロワーに表示されません。その代わり、ドキュメントによると、ユーザーがそれを見るには、新しいフォアグラウンド・サービスのタスク・マネージャーに移動する必要があるそうです。</p><p>ユーザーが通知許可を拒否した場合、これらのフォアグラウンドサービスに関連する通知はフォアグラウンドサービス（FGS）タスクマネージャーで引き続き表示されますが、通知ドロワーでは表示されません。</p><p>私はAndroid 13 Betaを使用していないので、フォアグラウンド・サービスが実行されているときにFGSタスク・マネージャがどのように「見える」ようになるか正確にはわかりませんが、フォアグラウンド・サービスに通知を強制する全体のポイントは、アプリケーションが実行されているときにユーザーが認識できるようにすることだと私は考えていました。Androidは、危険なパーミッション（例：ACCESS_BACKGROUND_LOCATION）を使用して、バックグラウンドプロセスとフォアグラウンドプロセスができることを制限しているため、これはセキュリティにも影響を及ぼします。この変更により、アプリはユーザーに明確に通知することなく、フォアグラウンドベースのパーミッションを使用することができます。</p><p>では、なぜフォアグラウンドサービスの通知を制限することにしたのでしょうか？つまり、そもそも通知を制限することの追加については、全く別の議論があるのです。しかし、Androidが通知の使用を強制するなら、それを回避する方法（つまり、POST_NOTIFICATION権限を決して要求しない、あるいは、プログラム的に権限を削除する）はないはずだと考えるでしょう。</p></blockquote><h2 id=pendingintentのflag_immutableとflag_mutable---kenji-abe---mediumhttpsstar-zeromediumcompendingintente381aeflag-immutablee381a8flag-mutable-d72bf7c90135><a class=link href=https://star-zero.medium.com/pendingintent%E3%81%AEflag-immutable%E3%81%A8flag-mutable-d72bf7c90135 target=_blank rel=noopener>PendingIntentのFLAG_IMMUTABLEとFLAG_MUTABLE - Kenji Abe - Medium</a></h2><blockquote><p>Target SDK 31(Android 12)から PendingIntent のmutability(可変性)を指定する必要があります。</p></blockquote><blockquote><p>FLAG_IMMUTABLE
FLAG_IMMUTABLE を指定すると、パラメータを追加をしたとしても、元々のIntentは変更はされず、起動された側でも取得できずにnullになります。
ほとんどケースで FLAG_IMMUTABLE を指定することになると思います。</p><p>FLAG_MUTABLE
FLAG_MUTABLE を指定すると、変更が可能となり、先程のパラメータを追加したときに、起動された側で取得することが出来ます。</p></blockquote><h2 id=長時間実行ワーカーをサポートする--android-デベロッパー--android-developershttpsdeveloperandroidcomtopiclibrariesarchitectureworkmanageradvancedlong-runninghlja><a class=link href="https://developer.android.com/topic/libraries/architecture/workmanager/advanced/long-running?hl=ja" target=_blank rel=noopener>長時間実行ワーカーをサポートする  |  Android デベロッパー  |  Android Developers</a></h2><h2 id=how-to-implement-a-foreground-service-in-android--by-satya-pavan-kantamani--better-programminghttpsbetterprogrammingpubwhat-is-foreground-service-in-android-3487d9719ab6><a class=link href=https://betterprogramming.pub/what-is-foreground-service-in-android-3487d9719ab6 target=_blank rel=noopener>How To Implement a Foreground Service in Android | by Satya Pavan Kantamani | Better Programming</a></h2><h2 id=using-foreground-services-for-executing-long-running-processes-in-android--by-harshit-dwivedi--heartbeathttpsheartbeatcometmlusing-foreground-services-for-executing-long-running-processes-in-android-fac0b8585c3a><a class=link href=https://heartbeat.comet.ml/using-foreground-services-for-executing-long-running-processes-in-android-fac0b8585c3a target=_blank rel=noopener>Using foreground services for executing long-running processes in Android | by Harshit Dwivedi | Heartbeat</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://tro3373.github.io/tags/android/>android</a></li><li><a href=https://tro3373.github.io/tags/kotlin/>kotlin</a></li></ul><nav class=paginav><a class=prev href=https://tro3373.github.io/posts/2022/2022-10-18-android_generate_build_config_class_for_env_variable_from_env_properties_file/><span class=title>« 前へ</span><br><span>Android で環境設定ファイルからBuildConfig環境変数を生成する</span></a>
<a class=next href=https://tro3373.github.io/posts/2022/2022-10-01-hugo-template-syntax-first-and-last-minus-mean/><span class=title>次へ »</span><br><span>Hugo template 使用時 `{{-` `-}}` の `-` の意味はホワイトスペース削除</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する on twitter" href="https://twitter.com/intent/tweet/?text=Android%20%e3%81%a7%20%e4%bd%8d%e7%bd%ae%e6%83%85%e5%a0%b1%e5%8f%96%e5%be%97%ef%bc%86Bluetooth%e6%8e%a5%e7%b6%9a%e3%82%92%e5%ae%9a%e6%9c%9f%e5%ae%9f%e8%a1%8c%e3%81%99%e3%82%8bForegroundService%e3%82%92%e5%ae%9f%e8%a3%85%e3%81%99%e3%82%8b&amp;url=https%3a%2f%2ftro3373.github.io%2fposts%2f2022%2f2022-10-07-implment_android_persistent_forground_service%2f&amp;hashtags=android%2ckotlin"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2ftro3373.github.io%2fposts%2f2022%2f2022-10-07-implment_android_persistent_forground_service%2f&amp;title=Android%20%e3%81%a7%20%e4%bd%8d%e7%bd%ae%e6%83%85%e5%a0%b1%e5%8f%96%e5%be%97%ef%bc%86Bluetooth%e6%8e%a5%e7%b6%9a%e3%82%92%e5%ae%9a%e6%9c%9f%e5%ae%9f%e8%a1%8c%e3%81%99%e3%82%8bForegroundService%e3%82%92%e5%ae%9f%e8%a3%85%e3%81%99%e3%82%8b&amp;summary=Android%20%e3%81%a7%20%e4%bd%8d%e7%bd%ae%e6%83%85%e5%a0%b1%e5%8f%96%e5%be%97%ef%bc%86Bluetooth%e6%8e%a5%e7%b6%9a%e3%82%92%e5%ae%9a%e6%9c%9f%e5%ae%9f%e8%a1%8c%e3%81%99%e3%82%8bForegroundService%e3%82%92%e5%ae%9f%e8%a3%85%e3%81%99%e3%82%8b&amp;source=https%3a%2f%2ftro3373.github.io%2fposts%2f2022%2f2022-10-07-implment_android_persistent_forground_service%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ftro3373.github.io%2fposts%2f2022%2f2022-10-07-implment_android_persistent_forground_service%2f&title=Android%20%e3%81%a7%20%e4%bd%8d%e7%bd%ae%e6%83%85%e5%a0%b1%e5%8f%96%e5%be%97%ef%bc%86Bluetooth%e6%8e%a5%e7%b6%9a%e3%82%92%e5%ae%9a%e6%9c%9f%e5%ae%9f%e8%a1%8c%e3%81%99%e3%82%8bForegroundService%e3%82%92%e5%ae%9f%e8%a3%85%e3%81%99%e3%82%8b"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ftro3373.github.io%2fposts%2f2022%2f2022-10-07-implment_android_persistent_forground_service%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する on whatsapp" href="https://api.whatsapp.com/send?text=Android%20%e3%81%a7%20%e4%bd%8d%e7%bd%ae%e6%83%85%e5%a0%b1%e5%8f%96%e5%be%97%ef%bc%86Bluetooth%e6%8e%a5%e7%b6%9a%e3%82%92%e5%ae%9a%e6%9c%9f%e5%ae%9f%e8%a1%8c%e3%81%99%e3%82%8bForegroundService%e3%82%92%e5%ae%9f%e8%a3%85%e3%81%99%e3%82%8b%20-%20https%3a%2f%2ftro3373.github.io%2fposts%2f2022%2f2022-10-07-implment_android_persistent_forground_service%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する on telegram" href="https://telegram.me/share/url?text=Android%20%e3%81%a7%20%e4%bd%8d%e7%bd%ae%e6%83%85%e5%a0%b1%e5%8f%96%e5%be%97%ef%bc%86Bluetooth%e6%8e%a5%e7%b6%9a%e3%82%92%e5%ae%9a%e6%9c%9f%e5%ae%9f%e8%a1%8c%e3%81%99%e3%82%8bForegroundService%e3%82%92%e5%ae%9f%e8%a3%85%e3%81%99%e3%82%8b&amp;url=https%3a%2f%2ftro3373.github.io%2fposts%2f2022%2f2022-10-07-implment_android_persistent_forground_service%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Android で 位置情報取得＆Bluetooth接続を定期実行するForegroundServiceを実装する on ycombinator" href="https://news.ycombinator.com/submitlink?t=Android%20%e3%81%a7%20%e4%bd%8d%e7%bd%ae%e6%83%85%e5%a0%b1%e5%8f%96%e5%be%97%ef%bc%86Bluetooth%e6%8e%a5%e7%b6%9a%e3%82%92%e5%ae%9a%e6%9c%9f%e5%ae%9f%e8%a1%8c%e3%81%99%e3%82%8bForegroundService%e3%82%92%e5%ae%9f%e8%a3%85%e3%81%99%e3%82%8b&u=https%3a%2f%2ftro3373.github.io%2fposts%2f2022%2f2022-10-07-implment_android_persistent_forground_service%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></div></footer><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//jokrlzy.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2026 <a href=https://tro3373.github.io/>tac lifelog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="コピー";function s(){t.innerHTML="コピーされました!",setTimeout(()=>{t.innerHTML="コピー"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>